<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Coloring Squares</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: Arial, sans-serif;
      min-height: 100vh;
      display: flex;
    }

    .sidebar {
      width: 25%;
      padding: 20px;
      background-color: #f5f5f5;
      border-right: 1px solid #ddd;
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .main-content {
      width: 75%;
      height: 100vh;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }
    
    #controls {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    #color-palette {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    
    .color-swatch {
      width: 30px;
      height: 30px;
      border: 2px solid black;
      cursor: pointer;
      border-radius: 5px;
    }
    
    .color-swatch.selected {
      outline: 3px solid black;
    }
    
    #grid {
      display: grid;
      gap: 1px;
      margin: 0;
      overflow: auto;
      padding: 0px;
      background: #fff;
      flex: 1;
      width: 75vw;
      height: 100vh;
    }
    
    .cell {
      width: auto;
      height: auto;
      aspect-ratio: 1;
      background-color: white;
      border: 0.1px solid #ccc;
    }

    .button {
      padding: 8px 12px;
      font-size: 16px;
      cursor: pointer;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 5px;
      transition: background-color 0.3s;
    }

    .button:hover {
      opacity: 0.9;
    }

    #clear-btn {
      background-color: #ff4d4d;
    }

    #clear-btn:hover {
      background-color: #cc0000;
    }

    .control-group {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .control-group label {
      font-weight: bold;
    }

    #custom-color {
      padding: 0;
      width: 100%;
      height: 40px;
      cursor: pointer;
    }

    #grid-size {
      padding: 8px;
      width: 100%;
      border: 1px solid #ddd;
      border-radius: 5px;
    }

    .buttons-group {
      display: flex;
      gap: 10px;
    }

    .buttons-group .button {
      flex: 1;
    }

    h1 {
      margin-bottom: 20px;
      color: #333;
    }

    @media (max-width: 768px) {
      body {
        flex-direction: column;
      }

      .sidebar {
        width: 100%;
        padding: 10px;
      }

      .main-content {
        width: 100%;
        height: calc(100vh - 300px);
      }

      #grid {
        scale: 0.8;
        #grid {
    display: grid;
    gap: 1px;
    margin: 0!important;
    overflow: auto;
    padding: 0!important;
    background: #fff;
    flex: 1;
    max-width: 75vw;
    height: 100vh;
}
      }
    }
  </style>
</head>
<body>
  <div class="sidebar">
    <h1>Coloring Squares</h1>

    <div id="controls">
      <div class="control-group">
        <label for="custom-color">Custom Color</label>
        <input type="color" id="custom-color" aria-label="Choose custom color">
      </div>

      <div class="control-group">
        <label>Color Palette</label>
        <div id="color-palette" role="toolbar" aria-label="Color palette">
          <!-- Colors will be injected by JS -->
        </div>
      </div>

      <div class="control-group">
        <label for="grid-size">Grid Size</label>
        <input type="number" id="grid-size" value="26" min="8" max="44" aria-label="Grid size">
      </div>

      <div class="buttons-group">
        <button id="save-btn" class="button" aria-label="Save drawing">Save</button>
        <button id="load-btn" class="button" aria-label="Load drawing">Load</button>
        <button id="clear-btn" class="button" aria-label="Clear drawing">Clear</button>
      </div>
    </div>
  </div>

  <div class="main-content">
    <div id="grid" role="grid" aria-label="Drawing grid">
      <!-- Grid will be generated by JS -->
    </div>
  </div>

  <script>
    const paletteColors = ["red", "green", "blue", "yellow", "orange", "purple", "black"];
    let selectedColor = paletteColors[0];
    let isDrawing = false;
    let gridSize = 26;

    function createGrid(size) {
      const grid = document.getElementById('grid');
      grid.innerHTML = '';
      
      // Calculate cell size to fit the viewport
      const cellWidth = `calc(70vw / ${size})`;
      const cellHeight = `calc(100vh / ${size})`;
      
      grid.style.gridTemplateColumns = `repeat(${size}, 1fr)`;
      grid.style.gridTemplateRows = `repeat(${size}, 1fr)`;

      for (let i = 0; i < size * size; i++) {
        const cell = document.createElement('div');
        cell.className = 'cell';
        cell.setAttribute('role', 'gridcell');
        cell.setAttribute('aria-label', `Cell ${i + 1}`);

        // Mouse events
        cell.addEventListener('mousedown', startDrawing);
        cell.addEventListener('mouseover', draw);
        
        // Touch events
        cell.addEventListener('touchstart', handleTouch);
        cell.addEventListener('touchmove', handleTouch);

        grid.appendChild(cell);
      }
    }

    function startDrawing(e) {
      isDrawing = true;
      e.target.style.backgroundColor = selectedColor;
    }

    function draw(e) {
      if (isDrawing) {
        e.target.style.backgroundColor = selectedColor;
      }
    }

    function handleTouch(e) {
      e.preventDefault();
      const touch = e.touches[0];
      const element = document.elementFromPoint(touch.clientX, touch.clientY);
      if (element && element.classList.contains('cell')) {
        element.style.backgroundColor = selectedColor;
      }
    }

    // Create color palette
    const palette = document.getElementById('color-palette');
    paletteColors.forEach(color => {
      const swatch = document.createElement('div');
      swatch.className = 'color-swatch';
      swatch.style.backgroundColor = color;
      swatch.setAttribute('role', 'button');
      swatch.setAttribute('aria-label', `Select ${color} color`);
      if (color === selectedColor) swatch.classList.add('selected');

      swatch.addEventListener('click', () => {
        selectedColor = color;
        document.querySelectorAll('.color-swatch').forEach(el => el.classList.remove('selected'));
        swatch.classList.add('selected');
      });

      palette.appendChild(swatch);
    });

    // Custom color picker
    const customColor = document.getElementById('custom-color');
    customColor.addEventListener('input', (e) => {
      selectedColor = e.target.value;
      document.querySelectorAll('.color-swatch').forEach(el => el.classList.remove('selected'));
    });

    // Grid size control
    const gridSizeInput = document.getElementById('grid-size');
    gridSizeInput.addEventListener('change', () => {
      gridSize = Math.min(Math.max(parseInt(gridSizeInput.value) || 26, 8), 44);
      gridSizeInput.value = gridSize;
      createGrid(gridSize);
    });

    // Save/Load functionality
    document.getElementById('save-btn').addEventListener('click', () => {
      const drawing = Array.from(document.querySelectorAll('.cell')).map(cell => cell.style.backgroundColor);
      localStorage.setItem('savedDrawing', JSON.stringify({
        colors: drawing,
        size: gridSize
      }));
      alert('Drawing saved!');
    });

    document.getElementById('load-btn').addEventListener('click', () => {
      const saved = JSON.parse(localStorage.getItem('savedDrawing'));
      if (saved) {
        gridSize = saved.size;
        gridSizeInput.value = gridSize;
        createGrid(gridSize);
        const cells = document.querySelectorAll('.cell');
        saved.colors.forEach((color, i) => {
          if (cells[i]) cells[i].style.backgroundColor = color || 'white';
        });
      } else {
        alert('No saved drawing found!');
      }
    });

    // Clear button functionality
    document.getElementById('clear-btn').addEventListener('click', () => {
      document.querySelectorAll('.cell').forEach(cell => {
        cell.style.backgroundColor = "white";
      });
    });

    // Stop drawing when mouse is released
    document.body.addEventListener('mouseup', () => {
      isDrawing = false;
    });
    document.body.addEventListener('mouseleave', () => {
      isDrawing = false;
    });

    // Initial grid creation
    createGrid(gridSize);
  </script>
</body>
</html>
